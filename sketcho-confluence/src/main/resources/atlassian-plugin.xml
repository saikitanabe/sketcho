<?xml version="1.0" encoding="UTF-8"?>

<atlassian-plugin key="${project.groupId}.${project.artifactId}"
	name="${project.name}" plugins-version="2">
	<plugin-info>
		<description>${project.description}</description>
		<version>${project.version}</version>
		<vendor name="${project.organization.name}" url="${project.organization.url}" />
		<param name="atlassian-licensing-enabled">true</param>
		<param name="plugin-icon">images/sketcho-confluence-icon.png</param>
		<param name="plugin-logo">images/sketcho-confluence-logo.png</param>
		<param name="plugin-banner">images/sketcho-confluence-banner.png</param>
		<param name="configure.url">/plugins/servlet/net.sevenscales.confluence.plugins.sketcho-confluence/license
		</param>
	</plugin-info>
	<web-item name="add-sketcho-action-web-ui" key="add-sketcho-action-web-ui"
		section="system.content.add/space" weight="400">
		<description key="item.add-draft-label-action-web-ui.link.desc">Adds Sketcho action into the Add menu.
		</description>
		<label key="Add Sketch" />
		<link linkId="add-sketcho-action">/plugins/add-sketcho/add-sketcho.action?pageId=$page.id
		</link>
		<icon height="16" width="16">
			<link>/download/resources/net.sevenscales.confluence.plugins.sketcho-confluence:sketcho-macro/images/sketcho-confluence-icon.png
			</link>
		</icon>
		<condition class="net.sevenscales.confluence.plugins.SpaceEditCondition" />
	</web-item>
	<xwork name="add-sketcho-action-xwork" key="add-sketcho-action-xwork">
		<description key="item.add-sketcho-action-xwork.link.desc" />
		<package name="add-sketcho" extends="default" namespace="/plugins/add-sketcho">
			<default-interceptor-ref name="defaultStack" />
			<action name="add-sketcho"
				class="net.sevenscales.confluence.plugins.AddSketchoAction">
				<result name="success" type="velocity">/templates/addsketcho.vm</result>
			</action>
			<!-- <action name="configure-sketcho" -->
			<!-- class="net.sevenscales.confluence.plugins.ConfigureSketchoAction" -->
			<!-- method="input"> -->
			<!-- <result name="input" type="velocity">/templates/configuresketcho.vm -->
			<!-- </result> -->
			<!-- </action> -->
			<!-- <action name="configure-sketcho-update" -->
			<!-- class="net.sevenscales.confluence.plugins.ConfigureSketchoAction" -->
			<!-- method="update"> -->
			<!-- <result name="error" type="velocity">/templates/configuresketcho.vm -->
			<!-- </result> -->
			<!-- <result name="success" type="velocity">/templates/configuresketcho.vm -->
			<!-- </result> -->
			<!-- </action> -->
		</package>
	</xwork>
	<xwork name="create-sketcho-action-xwork" key="create-sketcho-action-xwork">
		<description key="item.create-sketcho-action-xwork.link.desc" />
		<package name="create-sketcho" extends="default" namespace="/plugins/add-sketcho">
			<default-interceptor-ref name="defaultStack" />
			<action name="create-sketcho"
				class="net.sevenscales.confluence.plugins.CreateSketchoAction">
				<result name="success" type="redirect">${page.urlPath}</result>
				<result name="error" type="velocity">/templates/adderrorsketcho.vm
				</result>
				<!-- <result name="success" type="redirect">${@com.atlassian.confluence.util.GeneralUtil@customGetPageUrl(page)}focusedCommentId=${parentId}#comment-${parentId}</result> -->
			</action>
		</package>
	</xwork>
	<!-- <resource name="images/" type="download" location="images/"/> -->
	<macro name="sketcho" class="net.sevenscales.confluence.plugins.SketchoMacro"
		key="sketcho-macro"
		icon="/download/resources/net.sevenscales.confluence.plugins.sketcho-confluence:sketcho-macro/images/sketcho-confluence-icon.png">
		<description>Sketcho UML modeling macro.</description>
		<category name="visuals" />
		<resource name="js/" type="download" location="js/" />
		<resource name="images/" type="download" location="images/" />
		<parameters>
			<parameter name="name" type="string" />
		</parameters>
	</macro>
	<xhtml-macro key="sketcho-xhtml" name="sketcho"
		class="net.sevenscales.confluence.plugins.SketchoMacroV4"
		icon="/download/resources/net.sevenscales.confluence.plugins.sketcho-confluence:sketcho-macro/images/sketcho-confluence-icon.png">
		<category name="development" />
		<description>Sketcho UML modeling macro used with Confluence 4.
		</description>
		<device-type>mobile</device-type>
		<resource name="js/" type="download" location="js/" />
		<resource name="images/" type="download" location="images/" />
		<parameters>
			<parameter name="name" type="string" />
		</parameters>
	</xhtml-macro>
	<!-- <xhtml-macro name="sketcho-confluence" -->
	<!-- class="net.sevenscales.confluence.plugins.ExampleMacro" key="my-macro"> -->
	<!-- <parameters /> -->
	<!-- </xhtml-macro> -->
	<component name="storeHandler"
		class="net.sevenscales.sketchoconfluenceapp.server.utils.AttachmentStore"
		key="storeHandler" />
	<servlet name="Content Image Servlet" key="contentImageServlet"
		class="net.sevenscales.sketchoconfluenceapp.server.ContentImageController">
		<description>Content Image Servlet</description>
		<url-pattern>/resources/contentImage</url-pattern>
	</servlet>
	<!-- common folders -->
	<resource type="download" namePattern="dojo/*"
		location="js/dojo-release-1.7.2-custom/dojo/" />
	<resource type="download" namePattern="dijit/*"
		location="js/dojo-release-1.7.2-custom/dijit/" />
	<resource type="download" namePattern="dojox/*"
		location="js/dojo-release-1.7.2-custom/dojox/" />
	<resource type="download" name="js/" location="js/" />
	<resource type="download" name="images/" location="images/" />
	<web-resource key="script_resource" name="script_resource">
		<resource type="download" name="bootstrap.min.css" location="assets/css/bootstrap.min.css" />
		<resource type="download" name="jquery-ui.css"
			location="assets/jqueryui/jquery-ui-1.10.3.custom.min.css" />
		<resource type="download" name="Sketcho_confluence_app.css"
			location="style/Sketcho_confluence_app.css" />
		<resource type="download" name="images/" location="images/" />
	</web-resource>
	<web-resource key="dojo" name="dojo">
		<resource type="download" name="dojo/dojo.js"
			location="js/dojo-release-1.7.2-custom/dojo/dojo.js">
			<param name="batch" value="false" />
		</resource>
	</web-resource>
	<!-- <web-resource key="sketchboardme-mobile-resources" name="SketchboardMe 
		Resources for Mobile"> -->
	<!-- <resource type="download" name="initsbmemobile.js" location="js/initsbmemobile.js"> -->
	<!-- <param name="batch" value="false" /> -->
	<!-- </resource> -->
	<!-- <context>atl.confluence.macros.expand.mobile</context> -->
	<!-- </web-resource> -->

	<web-resource key="sketcho_confluence_app" name="sketcho_confluence_app">
		<resource type="download" name="jquery-1.7.1.min.js"
			location="assets/js/jquery-1.7.1.min.js">
			<param name="batch" value="false" />
		</resource>
		<resource type="download" name="jquery-ui.min.js"
			location="assets/jqueryui/jquery-ui-1.10.3.custom.min.js">
			<param name="batch" value="false" />
		</resource>
		<resource type="download"
			name="js/sketcho_confluence_app/sketcho_confluence_app.nocache.js"
			location="js/sketcho_confluence_app/sketcho_confluence_app.nocache.js">
			<param name="batch" value="false" />
		</resource>
		<resource type="download" name="initsketcho.js" location="js/initsketcho.js">
			<param name="batch" value="false" />
		</resource>
<!-- 		<resource type="download" name="bootstrap.min.js" location="assets/js/bootstrap.min.js"> -->
<!-- 			<param name="batch" value="false" /> -->
<!-- 		</resource> -->
		<resource type="download" name="bootstrap.js"
			location="assets/js/bootstrap.js">
			<param name="batch" value="false" />
		</resource>
<!-- 		<resource type="download" name="bootstrap-tooltip.js" -->
<!-- 			location="assets/js/bootstrap-tooltip.js"> -->
<!-- 			<param name="batch" value="false" /> -->
<!-- 		</resource> -->
<!-- 		<resource type="download" name="bootstrap-tab.js" location="assets/js/bootstrap-tab.js"> -->
<!-- 			<param name="batch" value="false" /> -->
<!-- 		</resource> -->
	</web-resource>
	<resource type="i18n" name="i18n"
		location="net.sevenscales.confluence.plugins.sketcho-confluence" />
	<component-import key="pluginAccessor"
		interface="com.atlassian.plugin.PluginAccessor" />
	<component-import key="pluginController"
		interface="com.atlassian.plugin.PluginController" />
	<component-import key="txTemplate"
		interface="com.atlassian.sal.api.transaction.TransactionTemplate" />
	<component-import key="applicationProperties"
		interface="com.atlassian.sal.api.ApplicationProperties" />
	<component-import key="templateRenderer"
		interface="com.atlassian.templaterenderer.TemplateRenderer" />
	<component-import key="pluginSettingsFactory"
		interface="com.atlassian.sal.api.pluginsettings.PluginSettingsFactory" />
	<component-import key="loginUriProvider"
		interface="com.atlassian.sal.api.auth.LoginUriProvider" />
	<component-import key="userManager"
		interface="com.atlassian.sal.api.user.UserManager" />
	<component-import key="i18nResolver"
		interface="com.atlassian.sal.api.message.I18nResolver" />
	<component key="thirdPartyPluginLicenseStorageManager"
		class="com.atlassian.upm.license.storage.lib.ThirdPartyPluginLicenseStorageManagerImpl" />
	<component key="pluginLicenseStoragePluginInstaller"
		class="com.atlassian.upm.license.storage.lib.PluginLicenseStoragePluginInstaller" />
	<component key="atlassianMarketplaceUriFactory"
		class="com.atlassian.upm.license.storage.lib.AtlassianMarketplaceUriFactoryImpl" />
	<servlet name="License Servlet" i18n-name-key="license-servlet.name"
		key="license-servlet" class="net.sevenscales.confluence.plugins.servlet.LicenseServlet">
		<description key="license-servlet.description">The License Servlet Plugin</description>
		<url-pattern>/net.sevenscales.confluence.plugins.sketcho-confluence/license
		</url-pattern>
	</servlet>
	<rest name="Store Rest Service" i18n-name-key="store-rest-service.name"
		key="store-rest-service" path="/storerestservice" version="1.0">
		<description key="store-rest-service.description">The Store Rest Service Plugin
		</description>
	</rest>
</atlassian-plugin>
