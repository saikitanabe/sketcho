(function(){var n,t,r,e,u,i,o,s,c,a,f,l,h,p,g,m,d,y,v,b,w,E,S,M,A,_,I,k,W,x,B,O,H,P,V,T,D,C,L,U,N,j,z,F,q,Q,Z,$,K,R,X,G,J,Y,nt,tt,rt,et,ut,it,ot,st,ct,at,ft=[].slice,lt={}.hasOwnProperty,ht=function(n,t){function r(){this.constructor=n}for(var e in t)lt.call(t,e)&&(n[e]=t[e]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},pt=function(n,t){return function(){return n.apply(t,arguments)}};n={toString:function(){return"Bacon"}},n.version="0.7.10",n.fromBinder=function(t,r){return null==r&&(r=ct.id),new a(B(n,"fromBinder",t,r),function(e){var u;return u=t(function(){var t,i,o,s,a,f;for(t=1<=arguments.length?ft.call(arguments,0):[],s=r.apply(null,t),C(s)&&ct.last(s)instanceof c||(s=[s]),o=n.more,a=0,f=s.length;f>a;a++)if(i=s[a],o=e(i=tt(i)),o===n.noMore||i.isEnd())return null!=u?u():n.scheduler.setTimeout(function(){return u()},0),o;return o})})},n.$={asEventStream:function(t,r,e){var u;return U(r)&&(u=[r,null],e=u[0],r=u[1]),ot(this.selector||this,"asEventStream",t,n.fromBinder(function(n){return function(e){return n.on(t,r,e),function(){return n.off(t,r,e)}}}(this),e))}},null!=(at="undefined"!=typeof jQuery&&null!==jQuery?jQuery:"undefined"!=typeof Zepto&&null!==Zepto?Zepto:null)&&(at.fn.asEventStream=n.$.asEventStream),n.fromEventTarget=function(t,r,e){var u,i,o,s,c,a;return u=null!=(o=t.addEventListener)?o:null!=(s=t.addListener)?s:t.bind,i=null!=(c=t.removeEventListener)?c:null!=(a=t.removeListener)?a:t.unbind,ot(n,"fromEventTarget",t,r,n.fromBinder(function(n){return u.call(t,r,n),function(){return i.call(t,r,n)}},e))},n.fromPromise=function(t,r){return ot(n,"fromPromise",t,n.fromBinder(function(n){return t.then(n,function(t){return n(new s(t))}),function(){return r?"function"==typeof t.abort?t.abort():void 0:void 0}},function(n){return[n,O()]}))},n.noMore=["<no-more>"],n.more=["<more>"],n.later=function(t,r){return ot(n,"later",t,r,n.sequentially(t,[r]))},n.sequentially=function(t,r){var e;return e=0,ot(n,"sequentially",t,r,n.fromPoll(t,function(){var n;return n=r[e++],e<r.length?n:e===r.length?[n,O()]:O()}))},n.repeatedly=function(t,r){var e;return e=0,ot(n,"repeatedly",t,r,n.fromPoll(t,function(){return r[e++%r.length]}))},n.spy=function(n){return Y.push(n)},Y=[],J=function(n){var t,r,e,u;if(Y.length&&!J.running)try{for(J.running=!0,u=[],r=0,e=Y.length;e>r;r++)t=Y[r],u.push(t(n));return u}finally{delete J.running}},st=function(n){return function(){var t,r,e,u;return e=arguments[0],t=2<=arguments.length?ft.call(arguments,1):[],"object"==typeof e&&t.length&&(r=e,u=t[0],e=function(){return r[u].apply(r,arguments)},t=t.slice(1)),n.apply(null,[e].concat(ft.call(t)))}},z=function(t,r){return st(function(){var e,u,i;return u=arguments[0],e=2<=arguments.length?ft.call(arguments,1):[],i=X(r,[function(n,t){return u.apply(null,ft.call(n).concat([t]))}]),ot.apply(null,[n,t,u].concat(ft.call(e),[n.combineAsArray(e).flatMap(i)]))})},n.fromCallback=z("fromCallback",function(){var t,r;return r=arguments[0],t=2<=arguments.length?ft.call(arguments,1):[],n.fromBinder(function(n){return F(r,t)(n),R},function(n){return[n,O()]})}),n.fromNodeCallback=z("fromNodeCallback",function(){var t,r;return r=arguments[0],t=2<=arguments.length?ft.call(arguments,1):[],n.fromBinder(function(n){return F(r,t)(n),R},function(n,t){return n?[new s(n),O()]:[t,O()]})}),n.fromPoll=function(t,r){return ot(n,"fromPoll",t,r,n.fromBinder(function(r){var e;return e=n.scheduler.setInterval(r,t),function(){return n.scheduler.clearInterval(e)}},r))},n.interval=function(t,r){return null==r&&(r={}),ot(n,"interval",t,r,n.fromPoll(t,function(){return K(r)}))},n.constant=function(t){return new g(B(n,"constant",t),function(n){return n(D(t)),n(O()),R})},n.never=function(){return ot(n,"never",n.fromArray([]))},n.once=function(t){return ot(n,"once",t,n.fromArray([t]))},n.fromArray=function(t){return E(t),t=I(t),new a(B(n,"fromArray",t),function(r){var e,u;return u=!1,e=function(){var i,o;return ct.empty(t)?r(O()):(o=t.splice(0,1)[0],i=r(tt(o)),i===n.noMore||u?void 0:e())},e(),function(){return u=!0}})},n.mergeAll=function(){var t;return t=1<=arguments.length?ft.call(arguments,0):[],C(t[0])&&(t=t[0]),ot.apply(null,[n,"mergeAll"].concat(ft.call(t),[ct.fold(t,n.never(),function(n,t){return n.merge(t)})]))},n.zipAsArray=function(){var t;return t=1<=arguments.length?ft.call(arguments,0):[],C(t[0])&&(t=t[0]),ot.apply(null,[n,"zipAsArray"].concat(ft.call(t),[n.zipWith(t,function(){var n;return n=1<=arguments.length?ft.call(arguments,0):[]})]))},n.zipWith=function(){var t,r,e;return t=arguments[0],r=2<=arguments.length?ft.call(arguments,1):[],U(t)||(e=[t,r[0]],r=e[0],t=e[1]),r=ct.map(function(n){return n.toEventStream()},r),ot.apply(null,[n,"zipWith",t].concat(ft.call(r),[n.when(r,t)]))},n.groupSimultaneous=function(){var r,e,u;return u=1<=arguments.length?ft.call(arguments,0):[],1===u.length&&C(u[0])&&(u=u[0]),e=function(){var n,e,i;for(i=[],n=0,e=u.length;e>n;n++)r=u[n],i.push(new t(r));return i}(),ot.apply(null,[n,"groupSimultaneous"].concat(ft.call(u),[n.when(e,function(){var n;return n=1<=arguments.length?ft.call(arguments,0):[]})]))},n.combineAsArray=function(){var t,r,e,u,i,o,s;for(i=1<=arguments.length?ft.call(arguments,0):[],1===i.length&&C(i[0])&&(i=i[0]),t=o=0,s=i.length;s>o;t=++o)u=i[t],N(u)||(i[t]=n.constant(u));return i.length?(e=function(){var n,t,e;for(e=[],n=0,t=i.length;t>n;n++)r=i[n],e.push(new y(r,!0,!1,r.subscribeInternal));return e}(),ot.apply(null,[n,"combineAsArray"].concat(ft.call(i),[n.when(e,function(){var n;return n=1<=arguments.length?ft.call(arguments,0):[]}).toProperty()]))):n.constant([])},n.onValues=function(){var t,r,e;return r=2<=arguments.length?ft.call(arguments,0,e=arguments.length-1):(e=0,[]),t=arguments[e++],n.combineAsArray(r).onValues(t)},n.combineWith=function(){var t,r;return t=arguments[0],r=2<=arguments.length?ft.call(arguments,1):[],ot.apply(null,[n,"combineWith",t].concat(ft.call(r),[n.combineAsArray(r).map(function(n){return t.apply(null,n)})]))},n.combineTemplate=function(t){var r,e,u,i,o,s,c,a,f,l;return c=[],l=[],s=function(n){return n[n.length-1]},f=function(n,t,r){return s(n)[t]=r},r=function(n,t){return function(r,e){return f(r,n,e[t])}},o=function(n,t){return function(r){return f(r,n,t)}},a=function(n){return C(n)?[]:{}},u=function(n,t){var e,u;return N(t)?(l.push(t),c.push(r(n,l.length-1))):t!==Object(t)||"function"==typeof t||t instanceof RegExp||t instanceof Date?c.push(o(n,t)):(u=function(n){return function(r){var e;return e=a(t),f(r,n,e),r.push(e)}},e=function(n){return n.pop()},c.push(u(n)),i(t),c.push(e))},i=function(n){return ct.each(n,u)},i(t),e=function(n){var r,e,u,i,o;for(u=a(t),r=[u],i=0,o=c.length;o>i;i++)e=c[i],e(r,n);return u},ot(n,"combineTemplate",t,n.combineAsArray(l).map(e))},H=0,c=function(){function n(){this.id=++H}return n.prototype.isEvent=function(){return!0},n.prototype.isEnd=function(){return!1},n.prototype.isInitial=function(){return!1},n.prototype.isNext=function(){return!1},n.prototype.isError=function(){return!1},n.prototype.hasValue=function(){return!1},n.prototype.filter=function(){return!0},n.prototype.inspect=function(){return this.toString()},n.prototype.log=function(){return this.toString()},n}(),l=function(n){function t(n){t.__super__.constructor.call(this),this.value=U(n)?ct.cached(n):ct.always(n)}return ht(t,n),t.prototype.isNext=function(){return!0},t.prototype.hasValue=function(){return!0},t.prototype.fmap=function(n){return this.apply(function(t){return function(){return n(t.value())}}(this))},t.prototype.apply=function(n){return new t(n)},t.prototype.filter=function(n){return n(this.value())},t.prototype.toString=function(){return ct.toString(this.value())},t.prototype.log=function(){return this.value()},t}(c),f=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return ht(t,n),t.prototype.isInitial=function(){return!0},t.prototype.isNext=function(){return!1},t.prototype.apply=function(n){return new t(n)},t.prototype.toNext=function(){return new l(this.value)},t}(l),o=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return ht(t,n),t.prototype.isEnd=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<end>"},t}(c),s=function(n){function t(n){this.error=n}return ht(t,n),t.prototype.isError=function(){return!0},t.prototype.fmap=function(){return this},t.prototype.apply=function(){return this},t.prototype.toString=function(){return"<error> "+ct.toString(this.error)},t}(c),T=0,p=function(){function t(n){this.combine=pt(this.combine,this),this.flatMapLatest=pt(this.flatMapLatest,this),this.fold=pt(this.fold,this),this.scan=pt(this.scan,this),this.id=++T,this.assign=this.onValue,ot(n,this)}return t.prototype.onValue=function(){var n;return n=q(arguments),this.subscribe(function(t){return t.hasValue()?n(t.value()):void 0})},t.prototype.onValues=function(n){return this.onValue(function(t){return n.apply(null,t)})},t.prototype.onError=function(){var n;return n=q(arguments),this.subscribe(function(t){return t.isError()?n(t.error):void 0})},t.prototype.onEnd=function(){var n;return n=q(arguments),this.subscribe(function(t){return t.isEnd()?n():void 0})},t.prototype.errors=function(){return ot(this,"errors",this.filter(function(){return!1}))},t.prototype.filter=function(){var t,r;return r=arguments[0],t=2<=arguments.length?ft.call(arguments,1):[],x(this,r,t,function(t){return ot(this,"filter",t,this.withHandler(function(r){return r.filter(t)?this.push(r):n.more}))})},t.prototype.takeWhile=function(){var t,r;return r=arguments[0],t=2<=arguments.length?ft.call(arguments,1):[],x(this,r,t,function(t){return ot(this,"takeWhile",t,this.withHandler(function(r){return r.filter(t)?this.push(r):(this.push(O()),n.noMore)}))})},t.prototype.endOnError=function(){var n,t;return t=arguments[0],n=2<=arguments.length?ft.call(arguments,1):[],null==t&&(t=!0),x(this,t,n,function(n){return ot(this,"endOnError",this.withHandler(function(t){return t.isError()&&n(t.error)?(this.push(t),this.push(O())):this.push(t)}))})},t.prototype.take=function(t){return 0>=t?n.never():ot(this,"take",t,this.withHandler(function(r){return r.hasValue()?(t--,t>0?this.push(r):(0===t&&this.push(r),this.push(O()),n.noMore)):this.push(r)}))},t.prototype.map=function(){var n,t;return t=arguments[0],n=2<=arguments.length?ft.call(arguments,1):[],t instanceof g?t.sampledBy(this,V):x(this,t,n,function(n){return ot(this,"map",n,this.withHandler(function(t){return this.push(t.fmap(n))}))})},t.prototype.mapError=function(){var n;return n=q(arguments),ot(this,"mapError",n,this.withHandler(function(t){return t.isError()?this.push(K(n(t.error))):this.push(t)}))},t.prototype.mapEnd=function(){var t;return t=q(arguments),ot(this,"mapEnd",t,this.withHandler(function(r){return r.isEnd()?(this.push(K(t(r))),this.push(O()),n.noMore):this.push(r)}))},t.prototype.doAction=function(){var n;return n=q(arguments),ot(this,"doAction",n,this.withHandler(function(t){return t.hasValue()&&n(t.value()),this.push(t)}))},t.prototype.skip=function(t){return ot(this,"skip",t,this.withHandler(function(r){return r.hasValue()?t>0?(t--,n.more):this.push(r):this.push(r)}))},t.prototype.skipDuplicates=function(n){return null==n&&(n=function(n,t){return n===t}),ot(this,"skipDuplicates",this.withStateMachine(h,function(t,r){return r.hasValue()?r.isInitial()||t===h||!n(t.get(),r.value())?[new d(r.value()),[r]]:[t,[]]:[t,[r]]}))},t.prototype.skipErrors=function(){return ot(this,"skipErrors",this.withHandler(function(t){return t.isError()?n.more:this.push(t)}))},t.prototype.withStateMachine=function(t,r){var e;return e=t,ot(this,"withStateMachine",t,r,this.withHandler(function(t){var u,i,o,s,c,a,f;for(u=r(e,t),i=u[0],s=u[1],e=i,c=n.more,a=0,f=s.length;f>a;a++)if(o=s[a],c=this.push(o),c===n.noMore)return c;return c}))},t.prototype.scan=function(t,r,e){var u,i,o,s,c;return i=nt(r),r=e?i:function(n,t){return i(n(),t())},u=ut(t).map(function(n){return ct.always(n)}),s=this,c=function(t){return function(e){var i,s,c,a;return i=!1,a=R,s=n.more,c=function(){return i?void 0:u.forEach(function(t){return i=!0,s=e(new f(t)),s===n.noMore?(a(),a=R):void 0})},a=t.subscribeInternal(function(t){var o,a;return t.hasValue()?i&&t.isInitial()?n.more:(t.isInitial()||c(),i=!0,a=u.getOrElse(function(){return void 0}),o=ct.cached(function(){return r(a,t.value)}),u=new d(o),e(t.apply(o))):(t.isEnd()&&(s=c()),s!==n.noMore?e(t):void 0)}),v.whenDoneWith(o,c),a}}(this),o=new g(B(this,"scan",t,r),c)},t.prototype.fold=function(n,t){return ot(this,"fold",n,t,this.scan(n,t).sampledBy(this.filter(!1).mapEnd().toProperty()))},t.prototype.zip=function(t,r){return null==r&&(r=Array),ot(this,"zip",t,n.zipWith([this,t],r))},t.prototype.diff=function(n,t){return t=nt(t),ot(this,"diff",n,t,this.scan([n],function(n,r){return[r,t(n[0],r)]}).filter(function(n){return 2===n.length}).map(function(n){return n[1]}))},t.prototype.flatMap=function(){return P(this,$(arguments))},t.prototype.flatMapFirst=function(){return P(this,$(arguments),!0)},t.prototype.flatMapLatest=function(){var n,t;return n=$(arguments),t=this.toEventStream(),ot(this,"flatMapLatest",n,t.flatMap(function(){return function(r){return Z(n(r)).takeUntil(t)}}(this)))},t.prototype.not=function(){return ot(this,"not",this.map(function(n){return!n}))},t.prototype.log=function(){var n;return n=1<=arguments.length?ft.call(arguments,0):[],this.subscribe(function(t){return"undefined"!=typeof console&&null!==console?"function"==typeof console.log?console.log.apply(console,ft.call(n).concat([t.log()])):void 0:void 0}),this},t.prototype.slidingWindow=function(n,t){return null==t&&(t=0),ot(this,"slidingWindow",n,t,this.scan([],function(t,r){return t.concat([r]).slice(-n)}).filter(function(n){return n.length>=t}))},t.prototype.combine=function(t,r){var e;return e=nt(r),ot(this,"combine",t,r,n.combineAsArray(this,t).map(function(n){return e(n[0],n[1])}))},t.prototype.decode=function(t){return ot(this,"decode",t,this.combine(n.combineTemplate(t),function(n,t){return t[n]}))},t.prototype.awaiting=function(t){return ot(this,"awaiting",t,n.groupSimultaneous(this,t).map(function(n){var t,r;return t=n[0],r=n[1],0===r.length}).toProperty(!1).skipDuplicates())},t.prototype.name=function(n){return this.toString=function(){return n},this},t.prototype.withDescription=function(){return B.apply(null,arguments).apply(this)},t}(),p.prototype.reduce=p.prototype.fold,P=function(t,r,u){return new a(B(t,"flatMap"+(u?"First":""),r),function(i){var o,s;return s=new e,o=function(n){return n(),s.empty()?i(O()):void 0},s.add(function(e,c){return t.subscribeInternal(function(t){var e;return t.isEnd()?o(c):t.isError()?i(t):u&&s.count()>1?n.more:s.unsubscribed?n.noMore:(e=Z(r(t.value())),s.add(function(t,r){return e.subscribeInternal(function(e){var u;return e.isEnd()?(o(r),n.noMore):(e instanceof f&&(e=e.toNext()),u=i(e),u===n.noMore&&t(),u)})}))})}),s.unsubscribe})},a=function(t){function r(n,t){this.takeUntil=pt(this.takeUntil,this),this.sampledBy=pt(this.sampledBy,this);var e;U(n)&&(t=n,n=[]),r.__super__.constructor.call(this,n),M(t),e=new i(t),this.subscribeInternal=e.subscribe,this.subscribe=v.wrappedSubscribe(this),this.hasSubscribers=e.hasSubscribers,J(this)}return ht(r,t),r.prototype.delay=function(t){return ot(this,"delay",t,this.flatMap(function(r){return n.later(t,r)}))},r.prototype.debounce=function(t){return ot(this,"debounce",t,this.flatMapLatest(function(r){return n.later(t,r)}))},r.prototype.debounceImmediate=function(t){return ot(this,"debounceImmediate",t,this.flatMapFirst(function(r){return n.once(r).concat(n.later(t).filter(!1))}))},r.prototype.throttle=function(n){return ot(this,"throttle",n,this.bufferWithTime(n).map(function(n){return n[n.length-1]}))},r.prototype.bufferWithTime=function(n){return ot(this,"bufferWithTime",n,this.bufferWithTimeOrCount(n,Number.MAX_VALUE))},r.prototype.bufferWithCount=function(n){return ot(this,"bufferWithCount",n,this.bufferWithTimeOrCount(void 0,n))},r.prototype.bufferWithTimeOrCount=function(n,t){var r;return r=function(r){return r.values.length===t?r.flush():void 0!==n?r.schedule():void 0},ot(this,"bufferWithTimeOrCount",n,t,this.buffer(n,r,r))},r.prototype.buffer=function(t,r,e){var u,i,o;return null==r&&(r=function(){}),null==e&&(e=function(){}),u={scheduled:!1,end:null,values:[],flush:function(){var t;if(this.scheduled=!1,this.values.length>0){if(t=this.push(K(this.values)),this.values=[],null!=this.end)return this.push(this.end);if(t!==n.noMore)return e(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:(this.scheduled=!0,t(function(n){return function(){return n.flush()}}(this)))}},o=n.more,U(t)||(i=t,t=function(t){return n.scheduler.setTimeout(t,i)}),ot(this,"buffer",this.withHandler(function(n){return u.push=this.push,n.isError()?o=this.push(n):n.isEnd()?(u.end=n,u.scheduled||u.flush()):(u.values.push(n.value()),r(u)),o}))},r.prototype.merge=function(t){var e;return S(t),e=this,new r(B(e,"merge",t),function(r){var u,i;return u=0,i=function(t){return function(e){return t.subscribeInternal(function(t){var i;return t.isEnd()?(u++,2===u?r(O()):n.more):(i=r(t),i===n.noMore&&e(),i)})}},k(i(e),i(t))})},r.prototype.toProperty=function(n){return 0===arguments.length&&(n=h),ot(this,"toProperty",n,this.scan(n,j,!0))},r.prototype.toEventStream=function(){return this},r.prototype.sampledBy=function(n,t){return ot(this,"sampledBy",n,t,this.toProperty().sampledBy(n,t))},r.prototype.concat=function(n){var t;return t=this,new r(B(t,"concat",n),function(r){var e,u;return u=R,e=t.subscribeInternal(function(t){return t.isEnd()?u=n.subscribeInternal(r):r(t)}),function(){return e(),u()}})},r.prototype.takeUntil=function(t){var r;return r={},ot(this,"takeUntil",t,n.groupSimultaneous(this.mapEnd(r),t.skipErrors()).withHandler(function(e){var u,i,o,s,c,a;if(e.hasValue()){if(a=e.value(),u=a[0],t=a[1],t.length)return this.push(O());for(i=n.more,s=0,c=u.length;c>s;s++)o=u[s],i=o===r?this.push(O()):this.push(K(o));return i}return this.push(e)}))},r.prototype.skipUntil=function(n){var t;return t=n.take(1).map(!0).toProperty(!1),ot(this,"skipUntil",n,this.filter(t))},r.prototype.skipWhile=function(){var t,r,e;return r=arguments[0],t=2<=arguments.length?ft.call(arguments,1):[],e=!1,x(this,r,t,function(t){return ot(this,"skipWhile",t,this.withHandler(function(r){return!e&&r.hasValue()&&t(r.value())?n.more:(r.hasValue()&&(e=!0),this.push(r))}))})},r.prototype.startWith=function(t){return ot(this,"startWith",t,n.once(t).concat(this))},r.prototype.withHandler=function(n){var t;return t=new i(this.subscribeInternal,n),new r(B(this,"withHandler",n),t.subscribe)},r}(p),g=function(t){function r(t,e,u){this.toEventStream=pt(this.toEventStream,this),this.toProperty=pt(this.toProperty,this),this.changes=pt(this.changes,this),this.sample=pt(this.sample,this),U(t)&&(u=e,e=t,t=[]),r.__super__.constructor.call(this,t),M(e),this.subscribeInternal=u===!0?e:new m(this,e,u).subscribe,this.sampledBy=function(t){return function(e,u){var i,o,s,c,a;return null!=u?u=nt(u):(i=!0,u=function(n){return n()}),a=new y(t,!1,!1,t.subscribeInternal,i),s=new y(e,!0,!1,e.subscribeInternal,i),c=n.when([a,s],u),o=e instanceof r?c.toProperty():c,ot(t,"sampledBy",e,u,o)}}(this),this.subscribe=v.wrappedSubscribe(this),J(this)}return ht(r,t),r.prototype.sample=function(t){return ot(this,"sample",t,this.sampledBy(n.interval(t,{})))},r.prototype.changes=function(){return new a(B(this,"changes"),function(n){return function(t){return n.subscribeInternal(function(n){return n.isInitial()?void 0:t(n)})}}(this))},r.prototype.withHandler=function(n){return new r(B(this,"withHandler",n),this.subscribeInternal,n)},r.prototype.toProperty=function(){return A(arguments),this},r.prototype.toEventStream=function(){return new a(B(this,"toEventStream"),function(n){return function(t){return n.subscribeInternal(function(n){return n.isInitial()&&(n=n.toNext()),t(n)})}}(this))},r.prototype.and=function(n){return ot(this,"and",n,this.combine(n,function(n,t){return n&&t}))},r.prototype.or=function(n){return ot(this,"or",n,this.combine(n,function(n,t){return n||t}))},r.prototype.delay=function(n){return this.delayChanges("delay",n,function(t){return t.delay(n)})},r.prototype.debounce=function(n){return this.delayChanges("debounce",n,function(t){return t.debounce(n)})},r.prototype.throttle=function(n){return this.delayChanges("throttle",n,function(t){return t.throttle(n)})},r.prototype.delayChanges=function(){var n,t,r;return n=2<=arguments.length?ft.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],ot.apply(null,[this].concat(ft.call(n),[b(this,t(this.changes()))]))},r.prototype.takeUntil=function(n){var t;return t=this.changes().takeUntil(n),ot(this,"takeUntil",n,b(this,t))},r.prototype.startWith=function(n){return ot(this,"startWith",n,this.scan(n,function(n,t){return t}))},r}(p),x=function(n,t,r,e){var u;return t instanceof g?(u=t.sampledBy(n,function(n,t){return[n,t]}),e.apply(u,[function(n){var t,r;return t=n[0],r=n[1],t}]).map(function(n){var t,r;return t=n[0],r=n[1]})):(t=F(t,r),e.apply(n,[t]))},b=function(t,r){var e;return e=new a(B(t,"justInitValue"),function(r){var u,i;return i=null,u=t.subscribeInternal(function(t){return t.hasValue()&&(i=t),n.noMore}),v.whenDoneWith(e,function(){return null!=i&&r(i),r(O())}),u}),e.concat(r).toProperty()},i=function(){function t(t,r){var e,u,i,o,s,c,a,f,l,h;null==t&&(t=function(){return R}),f=[],c=null,s=!1,u=!1,this.hasSubscribers=function(){return f.length>0},i=null,l=R,a=function(n){return f=ct.without(n,f)},h=null,e=function(){var n,t,r,e,u;if(null!=h){for(t=h,h=null,u=[],r=0,e=t.length;e>r;r++)n=t[r],u.push(n());return u}},o=function(t){var r,u,o,h,p,g;if(s)return c=(c||[]).concat([t]),n.more;if(t!==i){t.isError()&&(i=t),o=!1;try{for(s=!0,h=f,p=0,g=h.length;g>p;p++)u=h[p],r=u.sink(t),(r===n.noMore||t.isEnd())&&a(u);o=!0}finally{s=!1,o||(c=null)}for(o=!0;null!=c?c.length:void 0;)t=ct.head(c),c=ct.tail(c),this.push(t);return e(t),this.hasSubscribers()?n.more:(l(),n.noMore)}},this.push=function(n){return function(t){return v.inTransaction(t,n,o,[t])}}(this),null==r&&(r=function(n){return this.push(n)}),this.handleEvent=function(n){return function(t){return t.isEnd()&&(u=!0),r.apply(n,[t])}}(this),this.subscribe=function(n){return function(r){var e,i;return u?(r(O()),R):(M(r),e={sink:r},f=f.concat(e),1===f.length&&(i=t(n.handleEvent),l=function(){return i(),l=R}),M(l),function(){return a(e),n.hasSubscribers()?void 0:l()})}}(this)}return t}(),m=function(t){function r(t,e,u){var i,o,s,c;r.__super__.constructor.call(this,e,u),i=h,o=void 0,c=this.push,e=this.subscribe,s=!1,this.push=function(n){return function(t){return t.isEnd()&&(s=!0),t.hasValue()&&(i=new d(t),o=v.currentEventId()),c.apply(n,[t])}}(this),this.subscribe=function(r){return function(u){var c,a,f,l,h;return a=!1,l=n.more,f=function(){return l===n.noMore?R:s?(u(O()),R):e.apply(this,[u])},i.isDefined&&(r.hasSubscribers()||s)?(c=v.currentEventId(),h=o,!s&&h&&c&&c!==h?(v.whenDoneWith(t,function(){return o===h?u(D(i.get().value())):void 0}),f()):(v.inTransaction(void 0,r,function(){return l=u(D(i.get().value()))},[]),f())):f()}}(this)}return ht(r,t),r}(i),r=function(t){function r(){var t,e,u,i,o,c,a,f;u=void 0,c=[],t=!1,e=function(){return function(t){return function(r){return r.isEnd()?(f(t),n.noMore):u(r)}}}(this),a=function(){var n,t,r,e;for(e=[],t=0,r=c.length;r>t;t++)n=c[t],e.push("function"==typeof n.unsub?n.unsub():void 0);return e},o=function(n){return n.unsub=n.input.subscribeInternal(e(n.input))},f=function(n){var t,r,e,u;for(t=e=0,u=c.length;u>e;t=++e)if(r=c[t],r.input===n)return"function"==typeof r.unsub&&r.unsub(),c.splice(t,1),void 0},i=function(){return function(n){var t,r,e,i;for(u=n,i=I(c),r=0,e=i.length;e>r;r++)t=i[r],o(t);return a}}(this),r.__super__.constructor.call(this,B(n,"Bus"),i),this.plug=function(){return function(n){var r;if(!t)return r={input:n},c.push(r),null!=u&&o(r),function(){return f(n)}}}(this),this.push=function(){return function(n){return"function"==typeof u?u(K(n)):void 0}}(this),this.error=function(){return function(n){return"function"==typeof u?u(new s(n)):void 0}}(this),this.end=function(){return function(){return t=!0,a(),"function"==typeof u?u(O()):void 0}}(this)}return ht(r,t),r}(a),y=function(){function n(n,t,r,e,u,i){var o;this.obs=n,this.sync=t,this.subscribe=e,null==u&&(u=!1),null==i&&(i=[]),o=u?function(n){return function(){return n}}:ct.id,null==this.subscribe&&(this.subscribe=n.subscribeInternal),this.markEnded=function(){return this.ended=!0},this.toString=this.obs.toString,r?(this.consume=function(){return o(i.shift())},this.push=function(n){return i.push(n)},this.mayHave=function(n){return!this.ended||i.length>=n},this.hasAtLeast=function(n){return i.length>=n},this.flatten=!1):(this.consume=function(){return o(i[0])},this.push=function(n){return i=[n]},this.mayHave=function(){return!0},this.hasAtLeast=function(){return i.length},this.flatten=!0)}return n}(),t=function(n){function t(n){var r;this.obs=n,r=[],t.__super__.constructor.call(this,this.obs,!0,!1,this.obs.subscribeInternal,!1,r),this.consume=function(){var n;return n=r,r=[],function(){return n}},this.push=function(n){return r.push(n())},this.hasAtLeast=function(){return!0}}return ht(t,n),t}(y),y.fromObservable=function(n){return n instanceof y?n:n instanceof g?new y(n,!1,!1):new y(n,!0,!0)},B=function(){var n,t,r;return t=arguments[0],r=arguments[1],n=3<=arguments.length?ft.call(arguments,2):[],(t||r)instanceof u?t||r:new u(t,r,n)},u=function(){function n(n,t,r){var e,u,i,o;i=function(n){return C(n)?ct.flatMap(i,n):N(n)?[n]:n instanceof y?[n.obs]:[]},o=null,e=function(n){var t,r,u,i,s;for(r=n.internalDeps(),s=[],u=0,i=r.length;i>u;u++)t=r[u],o[t.id]=!0,s.push(e(t));return s},u=function(n){return null==o&&(o={},e(this)),o[n.id]},this.apply=function(e){var o;return o=ct.cached(function(){return i([n].concat(r))}),e.internalDeps=e.internalDeps||o,e.dependsOn=u,e.deps=o,e.toString=function(){return ct.toString(n)+"."+ct.toString(t)+"("+ct.map(ct.toString,r)+")"},e.inspect=function(){return e.toString()},e.desc=function(){return{context:n,method:t,args:r}},e}}return n}(),ot=function(){var n,t,r;return n=2<=arguments.length?ft.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],B.apply(null,n).apply(t)},n.when=function(){var t,r,e,u,i,o,s,c,f,l,h,p,g,m,d,b,E,S,M;if(l=1<=arguments.length?ft.call(arguments,0):[],0===l.length)return n.never();for(i=l.length,m="when: expecting arguments in the form (Observable+,function)+",w(m,i%2===0),g=[],f=[],r=0;i>r;){for(c=ct.toArray(l[r]),t=l[r+1],s={f:U(t)?t:function(){return t},ixs:[]},d=0,E=c.length;E>d;d++){for(p=c[d],w(N(p),m),e=ct.indexOf(g,p),0>e&&(g.push(p),e=g.length-1),M=s.ixs,b=0,S=M.length;S>b;b++)u=M[b],u.index===e&&u.count++;s.ixs.push({index:e,count:1})}c.length>0&&f.push(s),r+=2}return g.length?(g=ct.map(y.fromObservable,g),o=ct.any(g,function(n){return n.flatten})&&W(ct.map(function(n){return n.obs},g)),h=new a(B.apply(null,[n,"when"].concat(ft.call(l))),function(t){var e,u,i,s,c,a,l;return l=[],i=!1,s=function(n){var t,e,u;for(u=n.ixs,t=0,e=u.length;e>t;t++)if(r=u[t],!g[r.index].hasAtLeast(r.count))return!1;return!0},u=function(n){return!n.sync||n.ended},e=function(n){var t,e,u;for(u=n.ixs,t=0,e=u.length;e>t;t++)if(r=u[t],!g[r.index].mayHave(r.count))return!0},c=function(n){return!n.source.flatten},a=function(a){return function(p){var m,d,y;return d=function(){return v.whenDoneWith(h,m)},y=function(){var e,u,i,a,h,p;if(!(l.length>0))return n.more;for(i=n.more,a=l.pop(),h=0,p=f.length;p>h;h++)if(u=f[h],s(u))return e=function(){var n,t,e,i;for(e=u.ixs,i=[],n=0,t=e.length;t>n;n++)r=e[n],i.push(g[r.index].consume());return i}(),i=t(a.e.apply(function(){var n,t;return t=function(){var t,r,u;for(u=[],t=0,r=e.length;r>t;t++)n=e[t],u.push(n());return u}(),u.f.apply(u,t)})),l.length&&o&&(l=ct.filter(c,l)),i===n.noMore?i:y()},m=function(){var r;return r=y(),i&&(i=!1,(ct.all(g,u)||ct.all(f,e))&&(r=n.noMore,t(O()))),r===n.noMore&&p(),r},a.subscribe(function(r){var e;return r.isEnd()?(i=!0,a.markEnded(),d()):r.isError()?e=t(r):(a.push(r.value),a.sync&&(l.push({source:a,e:r}),o?d():m())),e===n.noMore&&p(),e||n.more})}},k.apply(null,function(){var n,t,r;for(r=[],n=0,t=g.length;t>n;n++)p=g[n],r.push(a(p));return r}())})):n.never()},W=function(t,r){var e;return null==r&&(r=[]),e=function(t){var u;return n._.contains(r,t)?!0:(u=t.internalDeps(),u.length?(r.push(t),n._.any(u,e)):(r.push(t),!1))},n._.any(t,e)},n.update=function(){var t,r,e,u;for(r=arguments[0],u=2<=arguments.length?ft.call(arguments,1):[],e=function(n){return function(){var t;return t=1<=arguments.length?ft.call(arguments,0):[],function(r){return n.apply(null,[r].concat(t))}}},t=u.length-1;t>0;)u[t]instanceof Function||(u[t]=function(n){return function(){return n}}(u[t])),u[t]=e(u[t]),t-=2;return ot.apply(null,[n,"update",r].concat(ft.call(u),[n.when.apply(n,u).scan(r,function(n,t){return t(n)})]))},k=function(){var n;return n=1<=arguments.length?ft.call(arguments,0):[],new e(n).unsubscribe},e=function(){function n(n){var t,r,e;for(null==n&&(n=[]),this.empty=pt(this.empty,this),this.count=pt(this.count,this),this.unsubscribe=pt(this.unsubscribe,this),this.add=pt(this.add,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[],r=0,e=n.length;e>r;r++)t=n[r],this.add(t)}return n.prototype.add=function(n){var t,r,e;if(!this.unsubscribed)return t=!1,r=R,this.starting.push(n),e=function(e){return function(){return e.unsubscribed?void 0:(t=!0,e.remove(r),ct.remove(n,e.starting))}}(this),r=n(this.unsubscribe,e),this.unsubscribed||t||this.subscriptions.push(r),ct.remove(n,this.starting),r},n.prototype.remove=function(n){return this.unsubscribed?void 0:void 0!==ct.remove(n,this.subscriptions)?n():void 0},n.prototype.unsubscribe=function(){var n,t,r,e;if(!this.unsubscribed){for(this.unsubscribed=!0,e=this.subscriptions,t=0,r=e.length;r>t;t++)n=e[t],n();return this.subscriptions=[],this.starting=[]}},n.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},n.prototype.empty=function(){return 0===this.count()},n}(),n.CompositeUnsubscribe=e,d=function(){function n(n){this.value=n}return n.prototype.getOrElse=function(){return this.value},n.prototype.get=function(){return this.value},n.prototype.filter=function(t){return t(this.value)?new n(this.value):h},n.prototype.map=function(t){return new n(t(this.value))},n.prototype.forEach=function(n){return n(this.value)},n.prototype.isDefined=!0,n.prototype.toArray=function(){return[this.value]},n.prototype.inspect=function(){return"Some("+this.value+")"},n.prototype.toString=function(){return this.inspect()},n}(),h={getOrElse:function(n){return n},filter:function(){return h},map:function(){return h},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},v=function(){var t,r,e,u,i,o,s,c,a,f,l;return c=void 0,a=[],r=[],t=function(n){return c?r.push(n):n()},s=function(n){return!ct.any(a,function(t){return n.obs.dependsOn(t.obs)})},f=function(n,t){return c?a.push({obs:n,f:t}):t()},u=function(){for(;!s(a[0]);)a.push(a.splice(0,1)[0]);return a.splice(0,1)[0]},i=function(){var n;for(n=[];a.length;)n.push(u().f());return n},o=function(n,t,e,u){var o;if(c)return e.apply(t,u);c=n;try{o=e.apply(t,u),i()}finally{for(c=void 0;r.length;)e=r.splice(0,1)[0],e()}return o},e=function(){return c?c.id:void 0},l=function(r){return function(e){var u,i,o;return o=!1,u=function(){},i=function(){return o=!0,u()},o||(u=r.subscribeInternal(function(r){return t(function(){var t;return o||(t=e(r),t!==n.noMore)?void 0:i()})})),i}},{whenDoneWith:f,inTransaction:o,currentEventId:e,wrappedSubscribe:l}}(),n.EventStream=a,n.Property=g,n.Observable=p,n.Bus=r,n.Initial=f,n.Next=l,n.End=o,n.Error=s,R=function(){},j=function(n,t){return t()},V=function(n){return n},D=function(n){return new f(ct.always(n))},K=function(n){return new l(ct.always(n))
},O=function(){return new o},tt=function(n){return n instanceof c?n:K(n)},I=function(n){return n.slice(0)},w=function(n,t){if(!t)throw n},S=function(n){if(!(n instanceof a))throw"not an EventStream : "+n},M=function(n){return w("not a function : "+n,U(n))},U=function(n){return"function"==typeof n},C=function(n){return n instanceof Array},N=function(n){return n instanceof p},E=function(n){if(!C(n))throw"not an array : "+n},A=function(n){return w("no arguments supported",0===n.length)},_=function(n){if("string"!=typeof n)throw"not a string : "+n},X=function(n,t){return function(){var r;return r=1<=arguments.length?ft.call(arguments,0):[],n.apply(null,t.concat(r))}},$=function(n){return 1===n.length&&N(n[0])?ct.always(n[0]):q(n)},q=function(n){return n=Array.prototype.slice.call(n),Q.apply(null,n)},Q=st(function(){var n,t;return t=arguments[0],n=2<=arguments.length?ft.call(arguments,1):[],U(t)?n.length?X(t,n):t:L(t)?rt(t,n):ct.always(t)}),F=function(n,t){return Q.apply(null,[n].concat(ft.call(t)))},Z=function(t){return N(t)?t:n.once(t)},L=function(n){return"string"==typeof n&&n.length>1&&"."===n.charAt(0)},n.isFieldKey=L,rt=function(n,t){var r,e;return e=n.slice(1).split("."),r=ct.map(it(t),e),function(t){var e,u;for(e=0,u=r.length;u>e;e++)n=r[e],t=n(t);return t}},it=function(n){return function(t){return function(r){var e;return null==r?void 0:(e=r[t],U(e)?e.apply(r,n):e)}}},et=function(n){return n.slice(1)},nt=function(n){var t;return U(n)?n:L(n)?(t=et(n),function(n,r){return n[t](r)}):w("not a function or a field key: "+n,!1)},ut=function(n){return n instanceof d||n===h?n:new d(n)},ct={indexOf:Array.prototype.indexOf?function(n,t){return n.indexOf(t)}:function(n,t){var r,e,u,i;for(r=u=0,i=n.length;i>u;r=++u)if(e=n[r],t===e)return r;return-1},indexWhere:function(n,t){var r,e,u,i;for(r=u=0,i=n.length;i>u;r=++u)if(e=n[r],t(e))return r;return-1},head:function(n){return n[0]},always:function(n){return function(){return n}},negate:function(n){return function(t){return!n(t)}},empty:function(n){return 0===n.length},tail:function(n){return n.slice(1,n.length)},filter:function(n,t){var r,e,u,i;for(r=[],u=0,i=t.length;i>u;u++)e=t[u],n(e)&&r.push(e);return r},map:function(n,t){var r,e,u,i;for(i=[],e=0,u=t.length;u>e;e++)r=t[e],i.push(n(r));return i},each:function(n,t){var r,e,u;u=[];for(r in n)e=n[r],u.push(t(r,e));return u},toArray:function(n){return C(n)?n:[n]},contains:function(n,t){return-1!==ct.indexOf(n,t)},id:function(n){return n},last:function(n){return n[n.length-1]},all:function(n,t){var r,e,u;for(null==t&&(t=ct.id),e=0,u=n.length;u>e;e++)if(r=n[e],!t(r))return!1;return!0},any:function(n,t){var r,e,u;for(null==t&&(t=ct.id),e=0,u=n.length;u>e;e++)if(r=n[e],t(r))return!0;return!1},without:function(n,t){return ct.filter(function(t){return t!==n},t)},remove:function(n,t){var r;return r=ct.indexOf(t,n),r>=0?t.splice(r,1):void 0},fold:function(n,t,r){var e,u,i;for(u=0,i=n.length;i>u;u++)e=n[u],t=r(t,e);return t},flatMap:function(n,t){return ct.fold(t,[],function(t,r){return t.concat(n(r))})},cached:function(n){var t;return t=h,function(){return t===h&&(t=n(),n=null),t}},toString:function(n){var t,r,e,u;try{return G++,null==n?"undefined":U(n)?"function":C(n)?G>5?"[..]":"["+ct.map(ct.toString,n).toString()+"]":null!=(null!=n?n.toString:void 0)&&n.toString!==Object.prototype.toString?n.toString():"object"==typeof n?G>5?"{..}":(r=function(){var r;r=[];for(e in n)lt.call(n,e)&&(u=function(){try{return n[e]}catch(r){return t=r}}(),r.push(ct.toString(e)+":"+ct.toString(u)));return r}(),"{"+r+"}"):n}finally{G--}}},G=0,n._=ct,n.scheduler={setTimeout:function(n,t){return setTimeout(n,t)},setInterval:function(n,t){return setInterval(n,t)},clearInterval:function(n){return clearInterval(n)},now:function(){return(new Date).getTime()}},"undefined"!=typeof define&&null!==define&&null!=define.amd?(define([],function(){return n}),this.Bacon=n):"undefined"!=typeof module&&null!==module?(module.exports=n,n.Bacon=n):this.Bacon=n}).call(this);